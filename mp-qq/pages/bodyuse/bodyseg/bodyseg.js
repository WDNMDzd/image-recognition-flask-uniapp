(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/bodyuse/bodyseg/bodyseg"],{"2b8a":function(e,t,o){"use strict";o.d(t,"b",(function(){return a})),o.d(t,"c",(function(){return s})),o.d(t,"a",(function(){return n}));var n={helangCompress:function(){return Promise.all([o.e("common/vendor"),o.e("components/helang-compress/helang-compress")]).then(o.bind(null,"c0a7"))},tColorPicker:function(){return o.e("components/t-color-picker/t-color-picker").then(o.bind(null,"d125"))}},a=function(){var e=this,t=e.$createElement;e._self._c},s=[]},6345:function(e,t,o){"use strict";o.r(t);var n=o("2b8a"),a=o("653f");for(var s in a)"default"!==s&&function(e){o.d(t,e,(function(){return a[e]}))}(s);o("7df8");var i,c=o("f0c5"),r=Object(c["a"])(a["default"],n["b"],n["c"],!1,null,null,null,!1,n["a"],i);t["default"]=r.exports},"636e":function(e,t,o){"use strict";(function(e){o("bae5");n(o("66fd"));var t=n(o("6345"));function n(e){return e&&e.__esModule?e:{default:e}}e(t.default)}).call(this,o("a821")["createPage"])},"653f":function(e,t,o){"use strict";o.r(t);var n=o("bea8"),a=o.n(n);for(var s in n)"default"!==s&&function(e){o.d(t,e,(function(){return n[e]}))}(s);t["default"]=a.a},"7df8":function(e,t,o){"use strict";var n=o("e819"),a=o.n(n);a.a},bea8:function(e,t,o){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=function(){o.e("components/t-color-picker/t-color-picker").then(function(){return resolve(o("d125"))}.bind(null,o)).catch(o.oe)},a=function(){o.e("components/t-table/t-table").then(function(){return resolve(o("35fc"))}.bind(null,o)).catch(o.oe)},s=function(){o.e("components/t-table/t-th").then(function(){return resolve(o("4920"))}.bind(null,o)).catch(o.oe)},i=function(){o.e("components/t-table/t-tr").then(function(){return resolve(o("c483"))}.bind(null,o)).catch(o.oe)},c=function(){o.e("components/t-table/t-td").then(function(){return resolve(o("fc6b"))}.bind(null,o)).catch(o.oe)},r=function(){Promise.all([o.e("common/vendor"),o.e("components/helang-compress/helang-compress")]).then(function(){return resolve(o("c0a7"))}.bind(null,o)).catch(o.oe)},l={components:{tTable:a,tTh:s,tTr:i,tTd:c,helangCompress:r,tColorPicker:n},data:function(){return{imgSrc:"",type:0,tableList:[],isHas:!1,title:"",caheight:0,isSave:!0,progressData:0,jd:"",isJd:!1,color:"#000000",imgBg:"",bgheight:0}},filters:{dealVal:function(e){var t=(100*parseFloat(e)).toString();return t=t.substr(0,5)+"%",t},dealXY:function(e){var t=parseFloat(e).toString();return t=t.substr(0,3),t}},onLoad:function(t){var o="欢迎您回来";t.text&&(o="已清空"),e.getStorage({key:"hasLook",success:function(){e.showToast({title:o,icon:"none",duration:1e3})},fail:function(){e.showModal({title:"提示",content:"背景图片和颜色二选一，选择背景图片后，背景色无效"}),e.setStorage({key:"hasLook",data:"yes"})}})},mounted:function(){},methods:{qkym:function(){e.redirectTo({url:"../bodyseg/bodyseg?text=已清空"})},upBg:function(){var t=this;e.chooseImage({count:1,success:function(o){t.imgBg=o.tempFilePaths[0],console.log(t.imgBg);var n=e.createCanvasContext("ones");e.getImageInfo({src:t.imgBg,success:function(o){var a=o.width,s=o.height;console.log(o),e.getSystemInfo({success:function(e){console.log(e);var o=s;s=e.windowWidth/a*s,t.bgheight=s,t.caheight=s,n.drawImage(t.imgBg,0,0,a,o,0,0,e.windowWidth,s),n.draw()}})}})}})},open:function(e){console.log(this.$refs),this.$refs.colorPickers.open()},confirm:function(e){console.log(e),this.color=e.hex},downF:function(t){var o=this;1==t?e.saveImageToPhotosAlbum({filePath:o.imgSrc,success:function(){e.showToast({title:"保存成功",icon:"none",duration:1500})}}):e.canvasToTempFilePath({canvasId:"ones",success:function(t){console.log(t.tempFilePath),e.saveImageToPhotosAlbum({filePath:t.tempFilePath,success:function(){e.showToast({title:"保存成功",icon:"none",duration:1500})}})}})},upfile:function(){var t=this;this.isSave=!0,t.progressData=0,e.chooseImage({count:1,success:function(o){t.jd="开始",t.isJd=!0,t.jd="压缩图片",t.imgSrc=o.tempFilePaths[0],t.$refs.helangCompress.compress({src:o.tempFilePaths[0],maxSize:800,fileType:"jpg",quality:.85,minSize:400}).then((function(o){t.jd="处理图像",console.log(o),e.uploadFile({sizeType:["original"],url:"xxxx/body",filePath:o,name:"file",formData:{type:5},success:function(o){if(e.showLoading({title:"加载中"}),"413"==o.statusCode)return console.log("sqdqw"),e.hideLoading(),void e.showToast({title:"图片过大",duration:1500});console.log(1232);var n=0,a=0,s=0;t.progressData=20,t.jd="定位人物",e.downloadFile({url:"xxxx/getImg?name="+o.data,success:function(o){console.log(o.tempFilePath),t.imgSrc=o.tempFilePath,t.progressData=40,e.getSystemInfo({success:function(o){console.log(o),t.jd="开始绘画",n=o.windowWidth,o.windowHeight,e.getImageInfo({src:t.imgSrc,success:function(o){console.log(o),a=o.width,s=o.height;t.progressData=60,e.uploadFile({url:"xxxx/body",filePath:t.imgSrc,name:"file",formData:{type:2},success:function(o){if(t.progressData=80,console.log(1232),""==t.imgBg){console.log(JSON.parse(o.data).person_info);var i=JSON.parse(o.data).person_info;if(i.length>1){t.caheight=s;var c=e.createCanvasContext("ones");c.setFillStyle(t.color),c.fillRect(0,0,n,s),c.draw(),c.drawImage(t.imgSrc,0,0,a,s,0,0,n,s),c.draw(!0)}else{var r=[],l=0,u=0,f=0,d=0,g=0,h=0,m=1;r=i[0].location,l=r.width*m,u=r.height*m,f=r.left,d=r.top,g=n/2-l/2,h=60;var p=e.createCanvasContext("ones");t.caheight=u+120,p.setFillStyle(t.color),p.fillRect(0,0,n,u+120),p.draw(),p.drawImage(t.imgSrc,f,d,l,u,g,h,l,u),p.draw(!0)}t.progressData=100,t.jd="完成",t.isJd=!1,t.isSave=!1}else{console.log(JSON.parse(o.data).person_info);var v=JSON.parse(o.data).person_info,b=[],w=0,S=0,x=0,y=0,P=0,I=0;t.caheight<s?I=t.caheight/s:n<a&&(I=n/a),b=v[0].location,w=b.width,S=b.height,x=b.left;var C=b.top,F=0,T=0;if(t.caheight<S?(y=b.top*I,F=w*I,T=S*I,P=n/2-F/2,0):(y=b.top,F=w,T=S,P=n/2-F/2,0),v.length>1){var k=v[0].location,j=v[v.length-1].location;x=k.left,C=k.top,w=j.left-k.left+j.width,S=k.height;var D=w,J=S;y=b.top,t.caheight<S&&(D=w*I,J=S*I,y=b.top*I),console.log(D),console.log(J),console.log(y),P=n/2-D/2;var _=e.createCanvasContext("ones");_.drawImage(t.imgSrc,0,0,a,s,0,0,n,s),_.draw(!0)}else{var B=e.createCanvasContext("ones");B.drawImage(t.imgSrc,x,C,w,S,P,y,F,T),B.draw(!0)}t.progressData=100,t.jd="完成",t.isJd=!1,t.isSave=!1}}})}})}})}}),e.hideLoading()}})}))}})}}};t.default=l}).call(this,o("a821")["default"])},e819:function(e,t,o){}},[["636e","common/runtime","common/vendor"]]]);